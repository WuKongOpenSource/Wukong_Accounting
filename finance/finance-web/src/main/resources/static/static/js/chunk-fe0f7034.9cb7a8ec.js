(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fe0f7034"],{"1c59":function(e,t,a){"use strict";var n=a("6d61"),i=a("6566");n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},"26b3":function(e,t,a){},"38cf":function(e,t,a){var n=a("23e7"),i=a("1148");n({target:"String",proto:!0},{repeat:i})},"432d":function(e,t,a){"use strict";a("26b3")},"4e82":function(e,t,a){"use strict";var n=a("23e7"),i=a("e330"),o=a("59ed"),l=a("7b0b"),r=a("07fa"),s=a("083a"),c=a("577e"),u=a("d039"),d=a("addb"),f=a("a640"),p=a("04d1"),h=a("d998"),m=a("2d00"),b=a("512ce"),v=[],g=i(v.sort),y=i(v.push),_=u((function(){v.sort(void 0)})),j=u((function(){v.sort(null)})),x=f("sort"),C=!u((function(){if(m)return m<70;if(!(p&&p>3)){if(h)return!0;if(b)return b<603;var e,t,a,n,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:a=3;break;case 68:case 71:a=4;break;default:a=2}for(n=0;n<47;n++)v.push({k:t+n,v:a})}for(v.sort((function(e,t){return t.v-e.v})),n=0;n<v.length;n++)t=v[n].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}})),w=_||!j||!x||!C,T=function(e){return function(t,a){return void 0===a?-1:void 0===t?1:void 0!==e?+e(t,a)||0:c(t)>c(a)?1:-1}};n({target:"Array",proto:!0,forced:w},{sort:function(e){void 0!==e&&o(e);var t=l(this);if(C)return void 0===e?g(t):g(t,e);var a,n,i=[],c=r(t);for(n=0;n<c;n++)n in t&&y(i,t[n]);d(i,T(e)),a=r(i),n=0;while(n<a)t[n]=i[n++];while(n<c)s(t,n++);return t}})},6062:function(e,t,a){a("1c59")},"8e5d":function(e,t,a){},b46f:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"k",(function(){return l})),a.d(t,"j",(function(){return r})),a.d(t,"i",(function(){return s})),a.d(t,"n",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"m",(function(){return f})),a.d(t,"d",(function(){return p})),a.d(t,"l",(function(){return h})),a.d(t,"o",(function(){return m})),a.d(t,"f",(function(){return b})),a.d(t,"h",(function(){return v})),a.d(t,"g",(function(){return g}));var n=a("b775");function i(e){return Object(n["a"])({url:"/financeReport/balanceSheetReport",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(e){return Object(n["a"])({url:"/financeReport/balanceSheetReport/balanceCheck",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return Object(n["a"])({url:"/financeReport/balanceSheetConfig/update",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function r(e){return Object(n["a"])({url:"/financeReport/incomeStatementReport",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function s(e){return Object(n["a"])({url:"/financeReport/incomeStatementReport/balanceCheck",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function c(e){return Object(n["a"])({url:"/financeReport/incomeStatementConfig/update",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(e){return Object(n["a"])({url:"/financeReport/cashFlowStatementReport",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function d(e){return Object(n["a"])({url:"/financeReport/cashFlowStatementReport/balanceCheck",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function f(e){return Object(n["a"])({url:"/financeReport/cashFlowStatementReport/update",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function p(e){return Object(n["a"])({url:"/financeReport/cashFlowStatementExtend/list",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function h(e){return Object(n["a"])({url:"/financeReport/cashFlowStatementExtend/update",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function m(e){return Object(n["a"])({url:"/financeReport/cashFlowStatementExtendConfig/update",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function b(e){return Object(n["a"])({url:"/financeReport/exportBalanceSheetReport",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"},responseType:"blob"})}function v(e){return Object(n["a"])({url:"financeReport/exportIncomeStatementReport",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"},responseType:"blob"})}function g(e){return Object(n["a"])({url:"financeReport/exportCashFlowStatementReport",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"},responseType:"blob"})}},b699:function(e,t,a){"use strict";var n=a("5530"),i=(a("99af"),a("add5")),o=a.n(i),l=a("2f62"),r=a("bc95");t["a"]={data:function(){return{printFooterShow:!1,pageTitle:"",searchTime:""}},mixins:[r["a"]],computed:Object(n["a"])(Object(n["a"])({},Object(l["c"])(["financeCurrentAccount"])),{},{displayTime:function(){return this.searchTime||this.dataTime&&this.$moment(this.dataTime,"YYYYMM").format("YYYY年第MM期")||this.dateValue&&this.$moment(this.dateValue,"YYYYMM").format("YYYY年第MM期")||this.timeArray&&this.timeArray.length&&this.getTimeShowVal(this.timeArray)}}),methods:{HandlerPrint:function(e,t){var a=this,n=t.title,i=void 0===n?"":n,l=t.style,r=void 0===l?"":l,s=t.centerText,c=void 0===s?"":s,u=t.headerHtml,d=void 0===u?"":u,f=t.type,p=void 0===f?"html":f;this.printFooterShow=!0;var h="\n      <div >\n        <div style='text-align:center;font-size:30px; font-weight:bold'>".concat(this.pageTitle||i,"</div>\n        <div style='display:flex; font-size:26px;padding: 10px 0'>\n          <span style=\"flex:1\">编制单位：").concat(this.financeCurrentAccount.companyName,'</span>\n          <span style="flex:1; text-align:center">').concat(c,'</span>\n          <span style="flex:1; text-align:right">\n          ').concat(this.displayTime||this.$moment(this.financeCurrentAccount.startTime,"YYYYMM").format("YYYY年第MM期"),"\n          </span>\n        </div>\n      </div>\n      ");this.$nextTick((function(){o()({printable:e,header:d||h,type:p,scanStyles:!1,style:"@page {size: auto;size:A3;margin:6mm}\n                  td,th{border:1px solid !important;padding: 10px 0;}\n                  table{border-collapse: collapse;font-size:20px;}\n                  .el-table__cell.gutter{border:none !important;}\n                  .el-table__empty-text{text-align: center;width: 100%;}\n                  tr{page-break-inside:avoid}\n                  .el-table__empty-text{display:none}\n                  .el-table__footer-wrapper{display:none}\n                  "+r,onLoadingEnd:function(){a.printFooterShow=!1}})}))}}}},bc34:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main"},[a("flexbox",{staticClass:"main-header",attrs:{justify:"space-between"}},[a("span",{staticClass:"main-title"},[e._v("\n          资产负债表\n          "),a("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":"40","data-id":"319"}})]),e._v(" "),a("el-dropdown",{staticClass:"receive-drop",attrs:{trigger:"click"}},[a("el-button",{staticClass:"dropdown-btn",attrs:{icon:"el-icon-more"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.$auth("finance.balanceSheet.print")?a("el-dropdown-item",{nativeOn:{click:function(t){return e.printClick(t)}}},[e._v("打印")]):e._e(),e._v(" "),e.$auth("finance.balanceSheet.export")?a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportTab(t)}}},[e._v("导出")]):e._e()],1)],1)],1),e._v(" "),a("flexbox",{staticClass:"content-flex",attrs:{justify:"space-between"}},[a("flexbox",{staticClass:"left-box"},[a("el-date-picker",{attrs:{"picker-options":e.pickerOptions,clearable:!1,format:"yyyy 第 MM 期","value-format":"yyyyMM",type:"month",placeholder:"选择月"},model:{value:e.dataTime,callback:function(t){e.dataTime=t},expression:"dataTime"}}),e._v(" "),a("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleRefresh,expression:"handleRefresh"}],attrs:{type:"subtle",icon:"el-icon-refresh-right"}})],1)],1),e._v(" "),a("div",{staticClass:"table-wrapper"},[a("el-table",{attrs:{id:"balanceSheet",data:e.tableData,height:e.tableHeight,border:"",stripe:""}},[e._l(e.fieldList,(function(t,n){return a("el-table-column",{key:n,attrs:{prop:t.field,align:t.align,label:t.label,width:t.width,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(n){var i=n.row,o=n.column;return[["name","name0"].includes(t.field)?[a("div",{staticClass:"name-box text-one-ellipsis",style:{paddingLeft:e.getNameIndent(i,t.field)}},[e._v("\n                  "+e._s(i[t.field])+"\n                  "),e.$auth("finance.balanceSheet.update")?a("i",{directives:[{name:"show",rawName:"v-show",value:"name"===o.property?i.editable:i.editable0,expression:"column.property === 'name' ? row.editable : row.editable0"}],staticClass:"wk wk-icon-modify",on:{click:function(t){e.openEditFormula(i,o)}}}):e._e()])]:["endPeriod","initialPeriod","endPeriod0","initialPeriod0"].includes(t.field)?[a("span",[e._v(e._s(e._f("filterValue")(i[t.field])))])]:[a("span",[e._v(e._s(0==i[t.field]?"":i[t.field]))])]]}}])})})),e._v(" "),e.printFooterShow?a("div",{staticStyle:{display:"flex","justify-content":"space-between",padding:"10px 0","font-size":"20px"},attrs:{slot:"append"},slot:"append"},[a("span",[e._v("单位负责人：")]),e._v(" "),a("span",[e._v("会计负责人:")]),e._v(" "),a("span",[e._v("制表人:")]),e._v(" "),a("span",[e._v("打印日期:"+e._s(e.$moment().format("YYYY-MM-DD")))])]):e._e()],2)],1),e._v(" "),a("div",{staticClass:"total-box"},[a("span",[e._v("共 "+e._s(e.tableData.length)+" 条")])]),e._v(" "),a("edit-formula",{attrs:{"edit-formula-visible":e.showEditFormula,"current-item":e.editItem,"sheet-type":"balanceSheet"},on:{editFormulaClose:e.closeEditFormula,"save-success":e.editSuccess}}),e._v(" "),e.verifyResult||!e.balance?a("el-dialog",{staticClass:"balance-dialog",attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,title:"系统提示",width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"balance-content"},[a("div",{staticClass:"text-box"},[a("span",{staticClass:"el-icon-warning"}),e._v(" "),a("span",[e._v(e._s(e.balanceMsg))])]),e._v(" "),e.verifyResult&&!e.verifyResult.initialBalance?a("div",{staticClass:"text-box"},[a("span",[e._v("财务初始余额不平,可通过")]),e._v(" "),a("span",{staticClass:"can-visit--underline",on:{click:e.initialBalance}},[e._v("财务初始余额")]),e._v(" "),a("span",[e._v("修改")])]):e._e(),e._v(" "),e.verifyResult&&!e.verifyResult.settled?a("div",{staticClass:"text-box"},[a("span",[e._v("本期尚未结转损益,可通过")]),e._v(" "),a("span",{staticClass:"can-visit--underline",on:{click:e.handleToSettle}},[e._v("结账")]),e._v(" "),a("span",[e._v("自动结转")])]):e._e(),e._v(" "),e.verifyResult&&e.verifyResult.notContains.length>0?a("div",{staticClass:"text-box"},[a("div",{staticClass:"text"},[e._v("您有未设置报表项目的科目：")]),e._v(" "),a("div",{staticClass:"subject-box"},e._l(e.verifyResult.notContains,(function(t,n){return a("div",{key:n,staticClass:"subject-item"},[e._v("\n                · "+e._s(t.number)+" "+e._s(t.subjectName)+"\n              ")])})))]):e._e()]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("忽略")])],1)]):e._e()],1)])},i=[],o=a("5530"),l=(a("a9e3"),a("99af"),a("d81d"),a("a630"),a("3ca3"),a("d3b7"),a("6062"),a("ddb0"),a("159b"),a("4de4"),a("14d9"),a("4e82"),a("b0c0"),a("b46f")),r=a("224e"),s=a("cbe3"),c=a("ed08"),u=a("8c73"),d=a("2f62"),f=a("b699"),p={name:"BalanceSheet",components:{EditFormula:s["a"]},filters:{filterValue:function(e){var t=Number(e);return isNaN(t)||0===t?"":Object(u["h"])(t)}},mixins:[f["a"]],data:function(){return{pageTitle:"资产负债表",loading:!1,type:1,dateValue:[],dataTime:"",tableHeight:document.documentElement.clientHeight-240,fieldList:[{label:"资产",field:"name",align:"left",width:150},{label:"行次",field:"sort",align:"center",width:80},{label:"期末数",field:"endPeriod",align:"right"},{label:"年初数",field:"initialPeriod",align:"right"},{label:"负债和所有者权益",field:"name0",align:"left",width:150},{label:"行次",field:"sort0",align:"center",width:80},{label:"期末数",field:"endPeriod0",align:"right"},{label:"年初数",field:"initialPeriod0",align:"right"}],tableData:[],editItem:{},showEditFormula:!1,balance:!0,dialogVisible:!1,verifyResult:null,printFooterShow:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(d["c"])(["financeCurrentAccount","financeFilterTimeRange"])),{},{balanceMsg:function(){var e=this.verifyResult&&(this.verifyResult.initialBalance||!this.verifyResult.settled||this.verifyResult.notContains.length>0);return"".concat(this.balance?"":"资产负债表不平,").concat(e?"请检查财务处理、":"").concat(this.balance?"":"报表项目公式设置")},pickerOptions:function(){var e=this;return{disabledDate:function(t){var a=e.$moment(t);return a.isBefore(e.financeFilterTimeRange.minTime.timeObj)||a.isAfter(e.financeFilterTimeRange.maxTime.timeObj)}}}}),watch:{dataTime:function(){this.handleRefresh()}},created:function(){var e=this;window.onresize=function(){e.tableHeight=document.documentElement.clientHeight-240},this.financeCurrentAccount&&this.financeCurrentAccount.startTime&&(this.dataTime=this.$moment(this.financeCurrentAccount.startTime).format("YYYYMM"))},methods:{getData:function(){var e=this;this.loading=!0,Object(l["b"])({fromPeriod:this.dataTime,toPeriod:this.dataTime,type:this.type}).then((function(t){if(e.loading=!1,e.tableData=e.formatData(t.data||[]),e.tableData.length){var a=e.tableData[e.tableData.length-1],n=a.endPeriod+a.initialPeriod===a.endPeriod0+a.initialPeriod0;e.balance=n,n||(e.dialogVisible=!0)}})).catch((function(){e.loading=!1}))},formatData:function(e){var t=[],a=["editable","endPeriod","formula","grade","initialPeriod","sort","id","name"],n=e.map((function(e){return e.rowId}));return n=Array.from(new Set(n)),n.forEach((function(n){var i=e.filter((function(e){return e.rowId===n})),l=i[0],r=i[1];if(l){var s={};a.forEach((function(e){s["".concat(e,"0")]=r?r[e]:null})),t.push(Object(o["a"])(Object(o["a"])({},l),s))}})),t},checkBalance:function(){var e=this;this.verifyResult=null,this.dialogVisible=!1,Promise.all([Object(l["a"])({fromPeriod:this.dataTime,toPeriod:this.dataTime,type:this.type}),Object(r["y"])()]).then((function(t){var a=t[0].data||{};a.initialBalance=1===Number(t[1].data.trialResult),(!a.settled||!a.initialBalance||a.notContains.length>0)&&(e.verifyResult=a,e.dialogVisible=!0)})).catch((function(){}))},handleRefresh:function(){this.getData(),this.checkBalance()},initialBalance:function(){this.dialogVisible=!1,this.$router.push({path:"/fm/manage/subs/manage-initial-balance-set"})},handleToSettle:function(){this.$router.push("/fm/settleAccounts")},getNameIndent:function(e,t){if(!e.grade&&!e.grade0)return"0";var a=Number("name"===t?e.grade:e.grade0);return isNaN(a)||a-1<0?"0":"".concat(14*(a-1),"px")},printClick:function(){this.HandlerPrint("balanceSheet",{title:"资产负债表"})},exportTab:function(){Object(l["f"])({fromPeriod:this.dataTime,toPeriod:this.dataTime,type:this.type,exportDataList:this.tableData}).then((function(e){Object(c["b"])(e)}))},editSuccess:function(){this.showEditFormula=!1,this.getData()},openEditFormula:function(e,t){var a="name"===t.property;this.editItem={id:a?e.id:e.id0,sort:a?e.sort:e.sort0,name:a?e.name:e.name0,formula:a?e.formula:e.formula0,endPeriod:a?e.endPeriod:e.endPeriod0,initialPeriod:a?e.initialPeriod:e.initialPeriod0},this.showEditFormula=!0},closeEditFormula:function(){this.showEditFormula=!1}}},h=p,m=(a("e040"),a("2877")),b=Object(m["a"])(h,n,i,!1,null,"18005e18",null);t["default"]=b.exports},bc95:function(e,t,a){"use strict";a("99af");t["a"]={methods:{getTimeShowVal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e[0]||null,a=e[1]||null;if(!t)return"";var n=this.$moment(t).format("YYYY年第MM期");if(!a)return n;var i=this.$moment(a).format("YYYY年第MM期");return n===i?n:"".concat(n," 至 ").concat(i)},getTimeInputWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.$moment(e[0]||null),a=this.$moment(e[1]||null);return t.isValid()&&a.isValid()&&t.format("YYYY-MM")!==a.format("YYYY-MM")?"230px":"180px"}}}},cbe3:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{ref:"wkDialog",attrs:{visible:e.editFormulaVisible,"before-close":e.editFormulaClose,"close-on-click-modal":!1,"append-to-body":!0,width:"900px"},on:{"update:visible":function(t){e.editFormulaVisible=t}}},[a("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[a("span",{staticClass:"title-box"},[e._v("编辑公式——"+e._s(e.currentItem.name?e.currentItem.name:""))])]),e._v(" "),a("flexbox",{staticClass:"content-flex"},[a("div",{staticClass:"flex-item"},[a("div",{staticClass:"text subject-text"},[e._v("科目：")]),e._v(" "),a("select-subject",{on:{change:e.receiveSubject},model:{value:e.subjectId,callback:function(t){e.subjectId=t},expression:"subjectId"}})],1),e._v(" "),a("div",{staticClass:"flex-item"},[a("div",{staticClass:"text"},[e._v("取数规则：")]),e._v(" "),"balanceSheet"==e.sheetType?a("el-select",{staticClass:"select-date",attrs:{placeholder:""},model:{value:e.balanceRules,callback:function(t){e.balanceRules=t},expression:"balanceRules"}},e._l(e.fetchOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))):a("el-select",{staticClass:"select-date",attrs:{placeholder:""},model:{value:e.cashRules,callback:function(t){e.cashRules=t},expression:"cashRules"}},e._l(e.fetchOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})))],1),e._v(" "),a("div",{staticClass:"flex-item"},[a("div",{staticClass:"text"},[e._v("运算符号：")]),e._v(" "),a("el-radio-group",{model:{value:e.operator,callback:function(t){e.operator=t},expression:"operator"}},[a("el-radio",{attrs:{label:1}},[e._v("+")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("-")])],1)],1),e._v(" "),a("el-button",{staticClass:"add",attrs:{type:"primary"},on:{click:e.addItem}},[e._v("添加")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%",margin:"20px 0"},attrs:{data:e.formulaList,"summary-method":e.getSummaries,"max-height":"250","show-summary":"",border:""}},[e._l(e.fieldList,(function(t,n){return a("el-table-column",{key:n,attrs:{prop:t.field,label:t.label,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(n){var i=n.row;return["rules"===t.field?a("span",[e._v(e._s(e._f("fetchValue")(i.rules)))]):"subjectName"===t.field?a("span",[e._v(e._s(i.subjectNumber)+"  "+e._s(i[t.field]))]):a("span",[e._v(e._s(i[t.field]))])]}}])})})),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.removeItem(t.row)}}},[e._v("删除")])]}}])})],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("flexbox",{staticClass:"footer-flex"},[a("div",{staticClass:"left tips"},[e._v("温馨提示：新公式只对未出报表进行计算，不影响历史报表数据。")]),e._v(" "),a("div",{staticClass:"right"},[a("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.save,expression:"save"}],attrs:{type:"primary"}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:e.editFormulaClose}},[e._v("取消")])],1)])],1)],1)},i=[],o=(a("7db0"),a("d3b7"),a("99af"),a("3c65"),a("c740"),a("a434"),a("159b"),a("d81d"),a("a9e3"),a("13d5"),a("4e82"),a("b46f")),l=a("cb41"),r=a("6bfe"),s=a("da92"),c={name:"EditFormula",components:{SelectSubject:l["a"]},filters:{fetchValue:function(e){return{0:"余额",1:"借方余额",2:"贷方余额",3:"科目借方余额",4:"科目贷方余额",5:"借方发生额",6:"贷方发生额",7:"损益发生额"}[e]}},props:{editFormulaVisible:Boolean,sheetType:{type:String,default:"balanceSheet"},currentItem:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,subjectId:"",subjectItem:{},balanceRules:0,cashRules:5,operator:1,formulaList:[]}},computed:{fetchOptions:function(){return"balanceSheet"===this.sheetType?[{value:0,label:"余额"},{value:1,label:"借方余额"},{value:2,label:"贷方余额"},{value:3,label:"科目借方余额"},{value:4,label:"科目贷方余额"}]:[{value:5,label:"借方发生额"},{value:6,label:"贷方发生额"},{value:7,label:"损益发生额"}]},fieldList:function(){return"balanceSheet"===this.sheetType?[{label:"科目",field:"subjectName"},{label:"运算符号",field:"operator"},{label:"取数规则",field:"rules"},{label:"期末数",field:"endPeriod"},{label:"年初数",field:"initialPeriod"}]:[{label:"科目",field:"subjectName"},{label:"运算符号",field:"operator"},{label:"取数规则",field:"rules"},{label:"本月数",field:"monthValue"},{label:"本年数",field:"yearValue"}]}},watch:{currentItem:{handler:function(e){!Object(r["c"])(e)&&e.formula&&(this.formulaList=JSON.parse(e.formula))},deep:!0,immediate:!0}},methods:{receiveSubject:function(e,t){this.subjectItem=t},addItem:function(){var e=this;if(Object(r["c"])(this.subjectItem))this.$message.warning("请填写科目！");else{var t=this.formulaList.find((function(t){return t.subjectId===e.subjectId}));if(t)this.$message.warning("科目不能重复添加！");else{var a={subjectId:this.subjectItem.subjectId,subjectName:"".concat(this.subjectItem.number," ").concat(this.subjectItem.subjectName),subjectNumber:this.subjectItem.subjectNumber,operator:1===this.operator?"+":"-"};"balanceSheet"===this.sheetType?(a.rules=this.balanceRules,a.endPeriod=0,a.initialPeriod=0):(a.rules=this.cashRules,a.lastMonthValue=0,a.monthValue=0,a.yearValue=0),this.formulaList.unshift(a),this.subjectItem=null,this.subjectId=null}}},removeItem:function(e){var t=this.formulaList.findIndex((function(t){return t.subjectId==e.subjectId}));this.formulaList.splice(t,1)},getSummaries:function(e){var t=e.columns,a=e.data,n=[];return t.forEach((function(e,t){if(0!==t)if("rules"!==e.property){var i=a.map((function(t){var a=Number(t[e.property]);if(!isNaN(a)){var n="+"===t.operator?1:-1;return a*n}return a}));i.every((function(e){return isNaN(e)}))?n[t]="":n[t]=i.reduce((function(e,t){return s["a"].plus(e,t)}))}else n[t]="";else n[t]="合计"})),n},editFormulaClose:function(){this.$emit("editFormulaClose")},save:function(){var e=this,t="balanceSheet"===this.sheetType?o["k"]:o["o"];t({formulaBOList:this.formulaList,id:this.currentItem.id,sort:this.currentItem.sort}).then((function(t){e.$message.success("保存成功"),e.$emit("save-success")})).catch((function(){}))}}},u=c,d=(a("432d"),a("2877")),f=Object(d["a"])(u,n,i,!1,null,"535d3e9c",null);t["a"]=f.exports},e040:function(e,t,a){"use strict";a("8e5d")}}]);