(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0dccc60a"],{"0ded":function(e,t,n){},"5afe":function(e,t,n){"use strict";n("0ded")},"9a4b":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"crm-ralative",attrs:{visible:e.visible,"close-on-click-modal":!1,title:e.getTitle(),width:e.contentWidth,"append-to-body":""},on:{close:e.closeView}},[n("div",{ref:"crContainer",staticClass:"cr-container-wrap"},[n("div",{staticClass:"cr-container"},[""!=e.crmType||e.commonConfig.isCommon?e._e():n("div",{staticClass:"cr-body-side"},[e._l(e.leftSides,(function(t,i){return n("div",{key:i,staticClass:"side-item",class:e.leftType===t.type?"side-item-select":"side-item-default",on:{click:function(n){e.sideClick(t)}}},[e._v(e._s(t.name)+"\n          "),t.num>0?n("span",{staticClass:"side-item__num"},[e._v(e._s("("+t.num+")"))]):e._e()])})),e._v(" "),"dept"==e.leftType?n("div",[n("el-tree",{attrs:{data:e.deptTreeList},on:{"node-click":e.handleDeptClick}})],1):e._e()],2),e._v(" "),e.commonConfig.isCommon?n("div",[n("crm-relative-table",{ref:"moduleTable",attrs:{props:e.commonConfig,"selected-data":e.currentSelectedData[e.leftType]},on:{"selection-change":function(t){e.selectionChange(t,e.leftSides.find((function(t){return t.type===e.leftType})))}}})],1):n("div",{style:{"padding-left":""==e.crmType?"150px":"0"}},[n("keep-alive",{attrs:{include:e.leftSides.filter((function(e){return e.loaded})).map((function(e){return e.component}))}},[n(e.getCurrentComponent(e.leftType),{ref:"moduleTable",tag:"component",staticClass:"crm-table-index",attrs:{props:e.componentConfig[e.leftType],"selected-data":e.currentSelectedData[e.leftType]},on:{"selection-change":function(t){e.selectionChange(t,e.leftSides.find((function(t){return t.type===e.leftType})))}}})],1)],1)]),e._v(" "),n("div",{class:["dialog-footer",{"is-common":e.commonConfig.isCommon}]},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirmClick(!1)}}},[e._v("确定")]),e._v(" "),n("el-button",{on:{click:e.closeView}},[e._v("取消")])],1)])])},a=[],c=n("5530"),s=(n("d3b7"),n("3ca3"),n("ddb0"),n("159b"),n("caad"),n("2532"),n("b64b"),n("14d9"),n("b0c0"),n("2934")),o=n("ed08"),r=n("8ed6"),l={isCommon:!1,type:"",name:""},d={name:"CrmRelatieve",components:{CrmRelativeTable:function(){return n.e("chunk-9dd2429e").then(n.bind(null,"38dd"))}},props:{visible:Boolean,radio:{type:Boolean,default:!0},acceptEmail:{type:String,default:""},crmType:{type:String,default:""},showTypes:{type:Array,default:function(){return["customer","contacts","leads","business","contract","product","receivables"]}},selectedData:{type:Object,default:function(){return{}}},props:Object,action:{type:Object,default:function(){return{type:"default",data:{}}}},actionObj:Object},provide:function(){return{elForm:"",elFormItem:""}},data:function(){return{leftType:"",leftSides:[],currentSelectedData:{},deptTreeList:[],deptId:""}},computed:{commonConfig:function(){return Object(r["a"])(Object(c["a"])({},l),this.action||{})},componentConfig:function(){var e=this,t=function(t){var n={};if(e.action&&"condition"===e.action.type&&(n[e.action.data.moduleType+"Id"]=e.action.data[e.action.data.moduleType+"Id"],e.action.data.params))for(var i in e.action.data.params)n[i]=e.action.data.params[i];var a={};e.actionObj&&(a=e.actionObj[t]);var o=Object(c["a"])(Object(c["a"])({isSelect:!0,showModuleName:!1,selectionHandle:!1,radio:e.radio,params:n,otherHeight:325},e.props||{}),a||{});return"dept"==t&&(o.fieldList=[{name:"姓名",fieldName:"realname"},{name:"邮箱",fieldName:"email"},{name:"手机号",fieldName:"username"},{name:"性别",fieldName:"sex"},{name:"部门",fieldName:"deptName"},{name:"岗位",fieldName:"post"}],o.request=s["i"],o.params={deptId:e.deptId,isNeedChild:1,limit:15,page:1,realname:""}),o},n={};return this.leftSides.forEach((function(e){n[e.type]=t(e.type)})),n},contentWidth:function(){return""!=this.crmType||this.commonConfig.isCommon?"910px":"1050px"}},watch:{visible:function(e){var t=this;e&&this.$nextTick((function(){var e=t.getCurrentMainTable();e.updateTableHeight&&e.updateTableHeight()}))},selectedData:function(e){this.handleCurrentSelectData(e)}},mounted:function(){this.handleCurrentSelectData(this.selectedData),this.showTypes.includes("dept")&&this.getDeptList()},methods:{handleCurrentSelectData:function(e){if(this.commonConfig.isCommon){var t={};t[this.commonConfig.type]=[],this.currentSelectedData=t}else if(e&&Object.keys(e).length)this.currentSelectedData=Object(o["s"])(e);else{var n={};if(this.crmType)n[this.crmType]=[],this.currentSelectedData=n;else{for(var i=0;i<this.showTypes.length;i++){var a=this.showTypes[i];n[a]=[]}this.currentSelectedData=n}}if(this.commonConfig.isCommon)this.leftSides.push({name:this.commonConfig.name,isCommon:!0,loaded:!0,num:0,type:this.commonConfig.type}),this.leftType=this.commonConfig.type;else if(0===this.leftSides.length){var c=this.getLeftItems();if(this.crmType){var s=c[this.crmType];s.loaded=!0,this.leftSides.push(s),this.leftType=this.crmType}else{for(var r=0;r<this.showTypes.length;r++){var l=c[this.showTypes[r]],d=this.currentSelectedData[l.type];l.num=d?d.length:0,this.leftSides.push(l)}if(this.leftSides.length>0){var m=this.leftSides[0];m.loaded=!0,this.leftType=m.type}}}else if(!this.crmType)for(var p=0;p<this.leftSides.length;p++){var u=this.leftSides[p],h=this.currentSelectedData[u.type];u.num=h?h.length:0}},refreshList:function(){this.$refs["crm"+this.crmType][0].refreshList()},sideClick:function(e){this.leftType=e.type,e.loaded=!0},closeView:function(){this.$emit("cancel"),this.closeEmit()},closeEmit:function(){this.$emit("close"),this.$emit("update:visible",!1)},selectionChange:function(e,t){t.num=e.length,this.currentSelectedData[this.leftType]=e},confirmClick:function(){var e=this;this.crmType&&(this.currentSelectedData[this.leftType]=this.getCurrentMainTable().selectionList),this.crmType?"receive"==this.acceptEmail?this.$emit("changeCheckout",{data:this.currentSelectedData[this.crmType],type:"receive"}):"sent"==this.acceptEmail?this.$emit("changeCheckout",{data:this.currentSelectedData[this.crmType],type:"sent"}):this.$emit("changeCheckout",{data:this.currentSelectedData[this.crmType]?this.currentSelectedData[this.crmType]:[]}):this.$emit("changeCheckout",{data:this.currentSelectedData}),this.$nextTick((function(){e.closeEmit()}))},getCurrentMainTable:function(){return this.$refs.moduleTable},getCurrentComponent:function(e){var t;return(null===(t=this.getLeftItems()[e])||void 0===t?void 0:t.component)||"CrmRelativeTable"},getTitle:function(){return this.commonConfig.isCommon?this.commonConfig.name:"leads"==this.crmType?"关联线索模块":"customer"==this.crmType?"关联客户模块":"contacts"==this.crmType?"关联联系人模块":"business"==this.crmType?"关联商机模块":"product"==this.crmType?"关联产品模块":"contract"==this.crmType?"关联合同模块":"receivables"==this.crmType?"关联回款模块":"item"==this.crmType?"关联事项":"关联相关信息"},setSelections:function(e){this.getCurrentMainTable().setSelections(e)},toggleRowSelection:function(e,t,n){this.getCurrentMainTable().toggleRowSelection(e,t,n)},getLeftItems:function(){return{customer:{name:"客户",loaded:!1,num:0,type:"customer",component:"CustomerIndex"},contacts:{name:"联系人",loaded:!1,num:0,type:"contacts",component:"ContactsIndex"},leads:{name:"线索",loaded:!1,num:0,type:"leads",component:"LeadsIndex"},business:{name:"商机",loaded:!1,num:0,type:"business",component:"BusinessIndex"},contract:{name:"合同",loaded:!1,num:0,type:"contract",component:"ContractIndex"},product:{name:"产品",loaded:!1,num:0,type:"product",component:"ProductIndex"},dept:{name:"同事",loaded:!1,num:0,type:"dept",component:"CrmRelativeTable"},receivables:{name:"回款",loaded:!1,num:0,type:"receivables",component:"ReceivablesIndex"},item:{name:"全部事项",loaded:!1,num:0,type:"item",component:"AllItem"}}},getDeptList:function(){var e=this;Object(s["f"])({type:"tree"}).then((function(t){e.deptTreeList=t.data})).catch((function(){}))},handleDeptClick:function(e){this.deptId=e.id}}},m=d,p=(n("5afe"),n("2877")),u=Object(p["a"])(m,i,a,!1,null,"5c34dd68",null);t["default"]=u.exports}}]);