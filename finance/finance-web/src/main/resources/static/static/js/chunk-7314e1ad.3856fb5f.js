(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7314e1ad"],{1188:function(e,t,n){},"1f01":function(e,t,n){"use strict";n("1188")},"2c86":function(e,t,n){},6055:function(e,t,n){},"73e4":function(e,t,n){"use strict";n("2c86")},8804:function(e,t,n){"use strict";n("6055")},"9ed6":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login"},[o("div",{staticClass:"login__content"},[o("div",{staticClass:"login-title"},[e._v("\n      "+e._s(null!==e.companyInfo.name&&""!==e.companyInfo.name?e.companyInfo.name:"悟空软件")+"\n    ")]),e._v(" "),"loginPwd"===e.loginType?o("login-by-pwd",{attrs:{username:e.username},on:{"update:username":function(t){e.username=t}}}):e._e()],1),e._v(" "),o("div",{staticClass:"footer"},[e.companyInfo.logo?o("img",{staticClass:"company-logo",attrs:{src:e.companyInfo.logo}}):o("div",{staticClass:"footer-title"},[o("img",{staticClass:"logo",attrs:{src:n("4ffd")}}),o("span",[e._v("悟空软件")])]),e._v(" "),o("div",{staticClass:"footer-des"},[e._v("一个账户可以访问 悟空CRM、悟空FS、悟空HRM 以及其他产品")])])])},a=[],s=(n("b0c0"),n("dea6")),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px","label-position":"top"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("div",{staticClass:"form-title"},[e._v("登录您的帐户")]),e._v(" "),n("el-form-item",{attrs:{label:"",prop:"username"}},[e.ruleResult.username.edit?n("el-input",{ref:"userInput",attrs:{disabled:e.loading,placeholder:"请输入手机号"},nativeOn:{keyup:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.continueClick(t)}},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username","string"===typeof t?t.trim():t)},expression:"ruleForm.username"}}):n("show-item",{attrs:{content:e.ruleForm.username},nativeOn:{click:function(t){e.editClick("username")}}})],1),e._v(" "),e.passwordShow?n("el-form-item",{attrs:{label:"",prop:"password"}},[n("el-input",{ref:"passwordInput",attrs:{type:e.passwordType,placeholder:"请输入密码"},nativeOn:{keyup:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.continueClick(t)}},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password","string"===typeof t?t.trim():t)},expression:"ruleForm.password"}},[n("i",{staticClass:"wk wk-icon-eye-solid",style:{color:""===e.passwordType?"#243858":"#C1C7D0"},attrs:{slot:"suffix"},on:{click:function(t){e.passwordType=""===e.passwordType?"password":""}},slot:"suffix"})])],1):e._e(),e._v(" "),n("div",{staticClass:"handle-bar"},[n("el-button",{attrs:{loading:e.loading,disabled:e.loading,type:"primary"},on:{click:e.continueClick}},[e._v(e._s(e.loginBtnName))])],1)],1)},i=[],u=n("c7eb"),c=n("1da1"),l=(n("d9e2"),n("14d9"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item-show"},[n("div",{staticClass:"item-show__inner"},[e._v(e._s(e.content))]),e._v(" "),e._m(0)])}),d=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"item-show__suffix"},[n("span",{staticClass:"item-show__suffix-inner"},[n("i",{staticClass:"wk wk-icon-follow-up"})])])}],m=(n("a9e3"),{name:"ShowItem",components:{},props:{content:[String,Number]},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{}}),f=m,p=(n("8804"),n("2877")),h=Object(p["a"])(f,l,d,!1,null,"fc9fb0a8",null),g=h.exports,w=n("7a1a"),v=n("6bfe"),y=(n("d3b7"),n("159b"),{data:function(){return{redirect:void 0}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},methods:{changeFormState:function(){var e=this;return new Promise((function(t,n){e.$nextTick((function(){var n=e.$refs.ruleForm;n.$children.forEach((function(t){t.prop&&(e.ruleResult[t.prop].validate="success"===t.validateState)})),t(e.ruleResult)}))}))}}}),b=n("5f87"),_={name:"LoginByPwd",components:{ShowItem:g},mixins:[y],props:{username:String},data:function(){var e=this,t=function(t,n,o){e.loading&&""===n?o(new Error("手机号不能为空")):o()};return{loading:!1,ruleForm:{username:"",password:""},ruleResult:{username:{validate:!1,edit:!0},password:{validate:!1,edit:!1}},rules:{username:[{required:!0,message:"手机号不能为空",trigger:"change"},{validator:t,trigger:""}],password:[{required:!0,message:"密码不能为空",trigger:"change"}]},passwordType:"password"}},computed:{passwordShow:function(){return!this.ruleResult.username.edit&&this.ruleResult.username.validate},loginBtnName:function(){return this.passwordShow?"登录":"继续"}},watch:{ruleForm:{handler:function(){var e=this;this.$nextTick((function(){e.changeFormState()}))},deep:!0},passwordShow:function(){var e=this;this.passwordShow&&this.$nextTick((function(){e.$refs.passwordInput.focus()}))},username:{handler:function(){this.ruleForm.username=this.username},immediate:!0},"ruleForm.username":{handler:function(e){this.$emit("update:username",e)}}},created:function(){window.accessLogin||Object(b["d"])(),this.debouncedHandleLogin=Object(w["debounce"])(300,this.handleLogin)},mounted:function(){},beforeDestroy:function(){},methods:{continueClick:function(){var e=this;this.loading=!0,this.$refs.ruleForm.validate(function(){var t=Object(c["a"])(Object(u["a"])().mark((function t(n){return Object(u["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!1,t.next=3,e.changeFormState();case 3:return e.ruleResult.username.validate&&(e.ruleResult.password.validate?(e.loading=!0,e.$store.dispatch("Login",e.ruleForm).then((function(t){e.loading=!1;var n=t.data;Object(v["a"])(n)?e.$emit("toggle","multiple",n,e.ruleForm):n.hasOwnProperty("companyList")?e.$emit("toggle","multiple",n.companyList,e.ruleForm):e.$router.push({path:e.redirect||"/"})})).catch((function(){e.loading=!1}))):e.ruleResult.username.edit=!1),t.abrupt("return",!1);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},editClick:function(e){var t=this;this.ruleResult[e].edit=!this.ruleResult[e].edit,this.ruleResult.password.validate=!1,"username"===e&&this.ruleResult[e].edit&&this.$nextTick((function(){t.$refs.userInput.focus()}))}}},k=_,C=(n("73e4"),Object(p["a"])(k,r,i,!1,null,"28027176",null)),F=C.exports,$=n("e297"),L=n.n($),O=n("ed08"),x=n("c9d9"),I={name:"Login",components:{LoginByPwd:F},props:{},data:function(){return{loginType:"loginPwd",username:"",companyList:[],companyInfo:{name:"",logo:""},loginParams:null}},computed:{},watch:{},created:function(){this.handleLoginCache("get"),this.getLogoAndName()},mounted:function(){},beforeDestroy:function(){},methods:{getLogoAndName:function(){var e=this;Object(s["a"])().then((function(t){var n=t.data;n&&e.handleLoginCache("set",n)})).catch((function(){}))},handleLoginCache:function(e,t){var n=window.location.hostname;if("get"===e){Object(O["y"])();var o=L.a.get(x["i"]);if(o&&o[n]){var a=o[n];this.companyInfo={name:a.companyName,logo:a.companyLoginLogo},Object(O["y"])(a)}}else if("set"===e){var s=L.a.get(x["i"])||{};s[n]=t,L.a.set(x["i"],s),this.companyInfo.logo=t.companyLoginLogo,this.companyInfo.name=t.companyName,Object(O["y"])(t)}}}},R=I,S=(n("1f01"),Object(p["a"])(R,o,a,!1,null,"5f4804d2",null));t["default"]=S.exports}}]);