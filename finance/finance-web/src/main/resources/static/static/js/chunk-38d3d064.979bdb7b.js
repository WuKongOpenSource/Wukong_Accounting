(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38d3d064"],{"1c59":function(t,e,n){"use strict";var a=n("6d61"),i=n("6566");a("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),i)},"224e":function(t,e,n){"use strict";n.d(e,"H",(function(){return i})),n.d(e,"D",(function(){return r})),n.d(e,"v",(function(){return c})),n.d(e,"C",(function(){return o})),n.d(e,"E",(function(){return l})),n.d(e,"F",(function(){return s})),n.d(e,"G",(function(){return u})),n.d(e,"I",(function(){return d})),n.d(e,"L",(function(){return f})),n.d(e,"J",(function(){return p})),n.d(e,"K",(function(){return b})),n.d(e,"u",(function(){return h})),n.d(e,"s",(function(){return m})),n.d(e,"t",(function(){return v})),n.d(e,"x",(function(){return g})),n.d(e,"w",(function(){return j})),n.d(e,"z",(function(){return y})),n.d(e,"y",(function(){return w})),n.d(e,"A",(function(){return C})),n.d(e,"B",(function(){return N})),n.d(e,"p",(function(){return T})),n.d(e,"k",(function(){return I})),n.d(e,"f",(function(){return x})),n.d(e,"r",(function(){return _})),n.d(e,"l",(function(){return B})),n.d(e,"g",(function(){return A})),n.d(e,"i",(function(){return O})),n.d(e,"h",(function(){return D})),n.d(e,"j",(function(){return k})),n.d(e,"q",(function(){return S})),n.d(e,"m",(function(){return U})),n.d(e,"n",(function(){return F})),n.d(e,"o",(function(){return L})),n.d(e,"a",(function(){return $})),n.d(e,"b",(function(){return V})),n.d(e,"d",(function(){return E})),n.d(e,"e",(function(){return q})),n.d(e,"c",(function(){return z}));n("d3b7"),n("159b"),n("b64b");var a=n("b775");function i(t){return Object(a["a"])({url:"financeSubject/queryListByType",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function r(t){return Object(a["a"])({url:"/financeSubject/".concat(t.subjectId?"update":"add"),method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function c(t){return Object(a["a"])({url:"/financeInitial/deleteByAssistId",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function o(t){return Object(a["a"])({url:"/financeInitial/queryByAdjuvant",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(t){return Object(a["a"])({url:"/financeSubject/deleteByIds",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function s(t){return Object(a["a"])({url:"/financeSubject/downloadExcel",method:"post",data:t,responseType:"blob",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function u(t){var e=new FormData;return Object.keys(t).forEach((function(n){e.append(n,t[n])})),Object(a["a"])({url:"/financeSubject/excelImport",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}function d(t){return Object(a["a"])({url:"/financeSubject/updateStatus",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function f(t){return Object(a["a"])({url:"/financeVoucher/queryList",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function p(t){return Object(a["a"])({url:"/financeVoucher/".concat(t.voucherId?"update":"add"),method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function b(t){return Object(a["a"])({url:"/financeVoucher/deleteById",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function h(t){return Object(a["a"])({url:"/financeCurrency/queryAllList",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function m(t){return Object(a["a"])({url:"/financeCurrency/".concat(t.currencyId?"update":"add"),method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function v(t){return Object(a["a"])({url:"/financeCurrency/deleteById",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function g(t){return Object(a["a"])({url:"/financeInitial/queryPageBySubjectType",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function j(t){return Object(a["a"])({url:"/financeInitial/add",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function y(t){return Object(a["a"])({url:"/financeInitial/update",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function w(t){return Object(a["a"])({url:"/financeInitial/queryTrialBalance",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function C(t){return Object(a["a"])({url:"/financeParameter/queryParameter",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function N(t){return Object(a["a"])({url:"/financeParameter/updateParameter",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function T(t){return Object(a["a"])({url:"financeAdjuvant/queryAllList",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function I(t){return Object(a["a"])({url:"financeAdjuvant/queryCustomList",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function x(t){return Object(a["a"])({url:"financeAdjuvant/add",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function _(t){return Object(a["a"])({url:"financeAdjuvant/update",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function B(t){return Object(a["a"])({url:"financeAdjuvant/deleteById",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function A(t){return Object(a["a"])({url:"financeAdjuvantCarte/add",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function O(t){return Object(a["a"])({url:"financeAdjuvantCarte/update",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function D(t){return Object(a["a"])({url:"financeAdjuvantCarte/deleteById",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function k(t){return Object(a["a"])({url:"financeAdjuvantCarte/updateStatusById",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function S(t){return Object(a["a"])({url:"financeAdjuvantCarte/queryByAdjuvantId",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function U(t){return Object(a["a"])({url:"financeAdjuvantCarte/downloadExcel",method:"post",data:t,responseType:"blob",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function F(t){var e=new FormData;return Object.keys(t).forEach((function(n){e.append(n,t[n])})),Object(a["a"])({url:"financeAdjuvantCarte/excelImport",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}function L(t){return Object(a["a"])({url:"financeAdjuvantCarte/exportExcel",method:"post",data:t,responseType:"blob",headers:{"Content-Type":"application/json;charset=UTF-8"}})}function $(t){return Object(a["a"])({url:"financeSubject/exportListByType",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"},responseType:"blob"})}function V(t){return Object(a["a"])({url:"financeCertificate/exportPageBySubjectType",method:"post",data:t,headers:{"Content-Type":"application/json;charset=UTF-8"},responseType:"blob"})}function E(t){return Object(a["a"])({url:"/financeCertificate/downloadFinanceInitialExcel",method:"post",data:t,headers:{"Content-Type":"application/json"},responseType:"blob"})}function q(t){var e=new FormData;return Object.keys(t).forEach((function(n){e.append(n,t[n])})),Object(a["a"])({url:"/financeCertificate/financeInitialImport",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})}function z(t){return Object(a["a"])({url:"/financeCertificate/checkSubjectCertificate",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}},"2bd8":function(t,e,n){"use strict";n("7e59")},"3ef5":function(t,e,n){},"3f9f":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"app-container"},[n("div",{staticClass:"content-header"},[n("span",[t._v("财务初始余额")]),t._v(" "),n("div",{staticClass:"buttons"},[t.$auth("finance.financialInitial.update")?n("el-button",{attrs:{type:"primary"},on:{click:t.saveSubmit}},[t._v("保存")]):t._e(),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.trialBalance}},[t._v("试算平衡")]),t._v(" "),n("el-dropdown",{staticClass:"receive-drop",attrs:{trigger:"click"}},[n("el-button",{staticClass:"dropdown-btn",attrs:{icon:"el-icon-more"}}),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.$auth("finance.financialInitial.export")?n("el-dropdown-item",{nativeOn:{click:function(e){return t.importAll(e)}}},[t._v("导入")]):t._e(),t._v(" "),t.$auth("finance.financialInitial.export")?n("el-dropdown-item",{nativeOn:{click:function(e){return t.exportAll(e)}}},[t._v("导出")]):t._e()],1)],1)],1)]),t._v(" "),n("flexbox",{staticClass:"content-flex",attrs:{justify:"space-between"}},[n("flexbox",{staticClass:"search"},[n("flexbox-item",t._l(t.balanceTypeOptions,(function(e,a){return n("el-button",{key:a,attrs:{type:t.balanceType==e.value?"selected":""},on:{click:function(n){t.balanceType=e.value}}},[t._v("\n          "+t._s(e.label)+"\n        ")])})))],1)],1),t._v(" "),n("div",{staticClass:"balance-table"},[n("el-table",{staticStyle:{width:"100%"},attrs:{id:"balance-table",data:t.balanceData,height:t.tableHeight,"cell-style":t.getCellStyle,"row-height":50,"use-virtual":"",stripe:""}},t._l(t.balanceList,(function(e,a){return n("el-table-column",{key:a,attrs:{prop:e.field,label:e.label,fixed:e.fixed,width:e.width,formatter:t.fieldFormatter,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return e.columns?void 0:[n("flexbox",{staticClass:"name-box"},["number"===e.field?[t._v("\n              "+t._s(t.getAssistNumber(a.row))+"\n            ")]:"subjectName"===e.field?n("div",{staticClass:"subjectName"},[t._v("\n              "+t._s(t.getAssistName(a.row))+"\n            ")]):[t._v("\n              "+t._s(t.fieldFormatter(a.row,e))+"\n            ")],t._v(" "),"subjectName"===e.field&&a.row.subjectAdjuvantList&&a.row.subjectAdjuvantList.length?n("i",{staticClass:"el-icon-plus",on:{click:function(e){t.handleToAddAssist(a.row)}}}):"subjectName"===e.field&&a.row.assistId?n("i",{staticClass:"el-icon-close",on:{click:function(e){t.handleDeleteAssist(a.row)}}}):t._e()],2)]}}])},[e.columns&&e.columns.length?t._l(e.columns,(function(e,a){return n("el-table-column",{key:a,attrs:{prop:e.field,label:e.label,formatter:t.fieldFormatter,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[t.getDisabledStatus(a.row,e,a.$index)?n("span",[t._v(t._s(a.row[e.field]&&t.separator(a.row[e.field])))]):t._e(),t._v(" "),t.getDisabledStatus(a.row,e,a.$index)?t._e():n("el-input-number",{attrs:{controls:!1},on:{change:function(n){t.inputChange(a.row,e)}},nativeOn:{paste:function(n){t.inputPaste(n,a.row,e)}},model:{value:a.row[e.field],callback:function(n){t.$set(a.row,e.field,n)},expression:"scope.row[children.field]"}})]}}])})})):t._e()],2)})))],1),t._v(" "),n("calculate-balance",{attrs:{"dialog-visible":t.calculateBalanceVisible},on:{close:function(e){t.calculateBalanceVisible=!1}}}),t._v(" "),t.addAssistVisible?n("add-assist-dialog",{attrs:{visible:t.addAssistVisible,"parent-node":t.assistParentNode,list:t.balanceData},on:{"update:visible":function(e){t.addAssistVisible=e},update:t.getBalanceGroupList}}):t._e()],1)},i=[],r=n("c7eb"),c=n("1da1"),o=n("5530"),l=(n("99af"),n("d81d"),n("4de4"),n("d3b7"),n("a9e3"),n("7db0"),n("13d5"),n("caad"),n("159b"),n("14d9"),n("2532"),n("224e")),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{ref:"wkDialog",attrs:{visible:t.dialogVisible,"before-close":t.close,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("span",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[t._v("\n    试算平衡\n    "),n("i",{staticClass:"wk wk-icon-fill-help wk-help-tips",attrs:{"data-type":"42","data-id":"335"}})]),t._v(" "),n("el-table",{attrs:{data:t.info}},t._l(t.fieldList,(function(e,a){return n("el-table-column",{key:a,attrs:{formatter:t.fieldFormatter,label:e.name,prop:e.field,width:e.width}})})))],1)},u=[],d=(n("ac1f"),n("5319"),n("b680"),{props:{dialogVisible:Boolean},data:function(){return{loading:!1,info:[],fieldList:[{name:"项目",field:"subject",width:"200px"},{name:"借方金额",field:"debtorBalance",width:"130px"},{name:"贷方金额",field:"creditBalance",width:"130px"},{name:"差额",field:"diff",width:"100"}]}},watch:{dialogVisible:function(t){t?this.getDetail():this.info=[]}},mounted:function(){},methods:{close:function(){this.$emit("close")},fieldFormatter:function(t,e){return["debtorBalance","creditBalance","diff"].includes(e.property)?t[e.property]?t[e.property].toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"):"0.00":t[e.property]},getDetail:function(){var t=this;this.loading=!0,Object(l["y"])().then((function(e){Number(e.data.trialResult)?t.$message.success("恭喜您，您录入的初始余额平衡！"):t.$message.warning("您录入的初始余额不平衡，请仔细核对"),t.info=[{subject:"期初余额（综合本位币）",creditBalance:e.data.creditBalance,debtorBalance:e.data.debtorBalance,diff:e.data.balanceDifferenceBalance},{subject:"累计发生额（综合本位币）",creditBalance:e.data.addUpCreditBalance,debtorBalance:e.data.addUpDebtorBalance,diff:e.data.addUpDifferenceBalance}],t.loading=!1})).catch((function(e){t.loading=!1}))}}}),f=d,p=(n("8c0c"),n("2877")),b=Object(p["a"])(f,s,u,!1,null,"fc4ec066",null),h=b.exports,m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.dialogVisible,"before-close":t.handleClose,"close-on-click-modal":!1,"append-to-body":"",title:"添加明细",width:"500px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{attrs:{"label-position":"left","label-width":"100px"}},[n("el-form-item",{attrs:{label:"科目："}},[n("el-input",{attrs:{disabled:""},model:{value:t.form.subjectName,callback:function(e){t.$set(t.form,"subjectName",e)},expression:"form.subjectName"}})],1),t._v(" "),n("div",{staticClass:"assist-text"},[t._v("辅助核算：")]),t._v(" "),t.showAssistForm&&t.form.assist?t._l(t.form.assist.assistAdjuvantList,(function(e,a){return n("el-form-item",{key:a,staticClass:"assist-item",attrs:{label:e.labelName}},[n("adjuvant-relative",{attrs:{"current-type":e.adjuvantId,label:e.label},on:{"value-change":function(n){t.relativeChange(n,e)}}})],1)})):t._e()],2),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:t.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[t._v("确定")]),t._v(" "),n("el-button",{on:{click:t.handleClose}},[t._v("取消")])],1)],1)},v=[],g=n("2909"),j=(n("cb29"),n("a15b"),n("a630"),n("3ca3"),n("6062"),n("ddb0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("flexbox",{staticClass:"user-container xh-form-border",class:[t.disabled?"is_disabled":"is_valid"],attrs:{slot:"reference",wrap:"wrap"},nativeOn:{click:function(e){return t.contentClick(e)}},slot:"reference"},[t._l(t.dataValue,(function(e,a){return n("div",{key:a,staticClass:"user-item"},[t._v("\n      "+t._s(e.carteName)+"\n    ")])})),t._v(" "),0==t.dataValue.length?n("div",{staticClass:"add-item"},[t._v("+添加")]):t._e()],2),t._v(" "),n("adjuvant-relative-list",{attrs:{"account-dialog-visible":t.accountDialogVisible,"current-type":t.currentType,label:t.label,"fixed-list":t.fixedList,"adjuvant-custom-list":t.adjuvantCustomList},on:{close:t.handlerClose,selectList:t.receiveAdjuvantList}})],1)}),y=[],w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"account-list"},[n("el-dialog",{staticClass:"account-dialog",attrs:{visible:t.accountDialogVisible,"before-close":t.cancel,title:t.relativeTitle,"append-to-body":"",width:"60%"},on:{"update:visible":function(e){t.accountDialogVisible=e}}},[n("div",{staticClass:"content-list"},[n("flexbox",{staticClass:"content-flex",attrs:{justify:"space-between"}},[n("div",{staticClass:"left-box"},[n("el-input",{staticClass:"searchInput",attrs:{size:"mini",placeholder:"输入关键词"},on:{change:function(e){t.searchInputChange()}},nativeOn:{keydown:function(e){return!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.handlerSearch(e))}},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}},[n("el-button",{attrs:{slot:"append"},on:{click:function(e){t.handlerSearch()}},slot:"append"},[t._v("查询")])],1)],1),t._v(" "),n("flexbox",{staticClass:"buttons"},[n("el-button",{staticClass:"rt",attrs:{type:"primary"},on:{click:t.addAdjuvant}},[t._v("新增")]),t._v(" "),n("el-button",{staticClass:"rt",attrs:{type:"primary"},on:{click:t.batchDelete}},[t._v("删除")]),t._v(" "),n("el-button",{staticClass:"rt",attrs:{type:"primary"},on:{click:t.importAccount}},[t._v("导入")]),t._v(" "),n("el-button",{staticClass:"rt",attrs:{type:"primary"},on:{click:t.exportAccount}},[t._v("导出")])],1)],1),t._v(" "),n("div",{staticClass:"account-table"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{id:"table",data:t.listData,height:"92%","row-key":"carteId",stripe:"","default-expand-all":"",border:""},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",selectable:t.canSelectRow,width:"55"}}),t._v(" "),t._l(t.accountList,(function(e,a){return n("el-table-column",{key:a,attrs:{prop:e.field,label:e.label,width:e.width,formatter:t.fieldFormatter,"show-overflow-tooltip":""}})})),t._v(" "),n("el-table-column",{attrs:{label:"状态",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){t.accountStatus(e)}}},[t._v("\n                "+t._s(1==e.row.status?"已启用":"已禁用")+"\n              ")])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"wk wk-icon-modify icon-btn",on:{click:function(n){t.accountEdit(e.row,n)}}}),t._v(" "),n("i",{staticClass:"wk wk-icon-bin icon-btn",on:{click:function(n){t.accountDelete(e.row)}}})]}}])})],2),t._v(" "),n("div",{staticClass:"p-contianer"},[n("el-pagination",{staticClass:"p-bar",attrs:{"current-page":t.currentPage,"page-sizes":t.pageSizes,"page-size":t.pageSize,total:t.total,background:"",layout:"prev, pager, next, sizes, total, jumper"},on:{"update:pageSize":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),n("el-dialog",{attrs:{visible:t.addDialogVisible,title:t.dialogTitle,"append-to-body":"",width:"25%"},on:{"update:visible":function(e){t.addDialogVisible=e}}},[n("el-form",{ref:"addForm",attrs:{model:t.addForm,rules:t.rules}},[n("el-form-item",{attrs:{"label-width":"80px",label:"编码：",prop:"carteNumber"}},[n("el-input",{model:{value:t.addForm.carteNumber,callback:function(e){t.$set(t.addForm,"carteNumber",e)},expression:"addForm.carteNumber"}})],1),t._v(" "),n("el-form-item",{attrs:{"label-width":"80px",label:"名称：",prop:"carteName"}},[n("el-input",{model:{value:t.addForm.carteName,callback:function(e){t.$set(t.addForm,"carteName",e)},expression:"addForm.carteName"}})],1),t._v(" "),6==t.label?n("el-form-item",{attrs:{"label-width":"80px",label:"规格：",prop:"specification"}},[n("el-input",{model:{value:t.addForm.specification,callback:function(e){t.$set(t.addForm,"specification",e)},expression:"addForm.specification"}})],1):t._e(),t._v(" "),6==t.label?n("el-form-item",{attrs:{"label-width":"80px",label:"单位：",prop:"unit"}},[n("el-input",{model:{value:t.addForm.unit,callback:function(e){t.$set(t.addForm,"unit",e)},expression:"addForm.unit"}})],1):t._e(),t._v(" "),[1,2].includes(t.label)?n("el-form-item",{attrs:{"label-width":"80px",label:"备注：",prop:"remark"}},[n("el-input",{attrs:{type:"textarea"},model:{value:t.addForm.remark,callback:function(e){t.$set(t.addForm,"remark",e)},expression:"addForm.remark"}})],1):t._e()],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.saveAdjuvant("addForm")}}},[t._v("保存")]),t._v(" "),n("el-button",{on:{click:function(e){t.closeAccountDialog()}}},[t._v("关闭")])],1)],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.confirm()}}},[t._v("确定")]),t._v(" "),n("el-button",{on:{click:function(e){t.cancel()}}},[t._v("取消")])],1)])],1)},C=[],N=(n("841c"),n("ed08")),T={name:"AdjuvantRelativeList",components:{},props:{accountDialogVisible:{type:Boolean,default:!1},currentType:{type:[String,Number],default:""},label:{type:[Number,String],default:function(){return""}}},data:function(){return{loading:!1,addDialogVisible:!1,isEdit:!1,searchValue:"",listData:[],multipleSelection:[],carteId:"",addForm:{carteNumber:"",carteName:"",specification:"",unit:"",remark:""},rules:{carteNumber:[{required:!0,message:"编码不能为空",trigger:"blur"}],carteName:[{required:!0,message:"名称不能为空",trigger:"blur"}]},currentPage:1,pageSize:10,pageSizes:[10,20,30,40,100,500],total:0}},computed:{relativeTitle:function(){return 7==this.label?"关联自定义辅助核算":[1,2,3,4,5,6].includes(this.label)?"关联"+{1:"客户",2:"供应商",3:"职员",4:"项目",5:"部门",6:"存货"}[this.label]:void 0},dialogTitle:function(){return this.isEdit?"编辑辅助核算":[1,2,3,4,5,6].includes(this.label)?"新增"+{1:"客户",2:"供应商",3:"职员",4:"项目",5:"部门",6:"存货"}[this.label]:void 0},accountList:function(){return[1,2].includes(this.label)?[{label:"编码",field:"carteNumber",width:"150px"},{label:"名称",field:"carteName"},{label:"备注",field:"remark"}]:[6].includes(this.label)?[{label:"编码",field:"carteNumber",width:"150px"},{label:"名称",field:"carteName"},{label:"规格",field:"specification"},{label:"单位",field:"unit"}]:[{label:"编码",field:"carteNumber",width:"150px"},{label:"名称",field:"carteName"}]}},watch:{currentType:{handler:function(t){t&&this.getAccountList()},immediate:!0}},created:function(){},methods:{cancel:function(){this.$emit("close",!1)},confirm:function(){this.$emit("close",!1),this.$emit("selectList",this.multipleSelection)},canSelectRow:function(t){return 1===t.status},getAccountList:function(t){var e=this;this.loading=!0;var n={page:this.currentPage,status:1,limit:this.pageSize,adjuvantId:this.currentType};t&&(n.search=t),Object(l["q"])(n).then((function(t){e.loading=!1,e.listData=t.data.list,e.total=t.data.totalRow})).catch((function(){e.loading=!1}))},searchInputChange:function(){this.searchValue||this.getAccountList()},handlerSearch:function(){this.getAccountList(this.searchValue)},handleCurrentChange:function(t){this.currentPage=t,this.getAccountList()},handleSizeChange:function(t){this.pageSize=t,this.getAccountList()},importAccount:function(){this.$wkImport.import("fmAssist",{typeName:"辅助项",historyShow:!1,noImportProcess:!0,ownerSelectShow:!1,repeatHandleShow:!1,importRequest:l["n"],templateRequest:l["m"],importParams:{label:this.label,adjuvantId:this.currentType},templateParams:{label:this.label}})},batchDelete:function(){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var e=t.multipleSelection.map((function(t){return t.carteId}));Object(l["h"])(e).then((function(e){t.$message.success("操作成功"),t.getAccountList(),t.loading=!1})).catch((function(){t.loading=!1})).catch((function(){}))}))},exportAccount:function(){var t={page:this.currentPage,status:1,limit:this.pageSize,adjuvantId:this.currentType};this.searchValue&&(t.page=1,t.search=this.searchValue),Object(l["o"])(t).then((function(t){Object(N["b"])(t)})).catch((function(){}))},handleSelectionChange:function(t){this.multipleSelection=t},fieldFormatter:function(t,e){return t[e.property]},accountEdit:function(t){this.isEdit=!0,this.addDialogVisible=!0,this.carteId=t.carteId;var e=t.carteNumber,n=t.carteName,a=t.specification,i=t.unit,r=t.remark;this.addForm={carteNumber:e,carteName:n,specification:a,unit:i,remark:r}},accountDelete:function(t){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n=[t.carteId];Object(l["h"])(n).then((function(t){e.$message.success("操作成功"),e.getAccountList()})).catch((function(){}))})).catch((function(){}))},accountStatus:function(t){var e=this;this.$confirm("您确定要"+(1==t.row.status?"停用":"启用")+"该辅助项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["j"])({carteId:t.row.carteId,status:1==t.row.status?2:1}).then((function(n){t.row["status"]=1==t.row["status"]?2:1,e.multipleSelection.find((function(e){return e===t.row}))&&e.$refs.table.toggleRowSelection(t.row,!1),e.$message({type:"success",message:"操作成功"})})).catch((function(){}))})).catch((function(){}))},addAdjuvant:function(){this.resetForm(),this.isEdit=!1,this.addDialogVisible=!0},saveAdjuvant:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;var n=e.isEdit?l["i"]:l["g"],a=Object(o["a"])(Object(o["a"])({},e.addForm),{},{adjuvantId:e.currentType});e.isEdit&&(a.carteId=e.carteId),n(a).then((function(t){e.getAccountList()})).catch((function(){})),e.resetForm(),e.addDialogVisible=!1}))},closeAccountDialog:function(){this.isEdit=!1,this.addDialogVisible=!1,this.resetForm()},resetForm:function(){this.addForm={carteNumber:"",carteName:"",specification:"",unit:"",remark:""}}}},I=T,x=(n("b720"),Object(p["a"])(I,w,C,!1,null,"61af3ba0",null)),_=x.exports,B={name:"AdjuvantRelative",components:{AdjuvantRelativeList:_},props:{currentType:{type:[String,Number],default:1},label:{type:[Number,String],default:function(){return""}},value:{type:[Number,String],default:function(){return""}}},data:function(){return{accountDialogVisible:!1,disabled:!1,fixedList:[],adjuvantCustomList:[],dataValue:[]}},computed:{},watch:{value:{handler:function(t){},immediate:!0},label:{handler:function(t){},immediate:!0}},created:function(){},mounted:function(){},methods:{contentClick:function(){this.accountDialogVisible=!0},handlerClose:function(){this.accountDialogVisible=!1},receiveAdjuvantList:function(t){this.$emit("value-change",t),this.dataValue=t}}},A=B,O=(n("cba6"),Object(p["a"])(A,j,y,!1,null,"75253b28",null)),D=O.exports,k={name:"AddAssistDialog",components:{AdjuvantRelative:D},props:{visible:{type:Boolean,default:!1},parentNode:{type:Object,required:!0},list:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!1,loading:!1,form:{},relative:{}}},computed:{showAssistForm:function(){return this.parentNode&&this.parentNode.subjectAdjuvantList&&this.parentNode.subjectAdjuvantList.length>0}},watch:{visible:{handler:function(){var t=this;this.dialogVisible=this.visible,this.visible&&this.$nextTick((function(){var e=Object(N["s"])(t.parentNode.subjectAdjuvantList);e.forEach((function(t){t.relationId=[],delete t.companyId})),t.form=Object(o["a"])(Object(o["a"])({},t.parentNode),{},{beginningBalance:0,beginningNum:0,initialBalance:0,initialNum:0,addUpCreditBalance:0,addUpCreditNum:0,addUpDebtorBalance:0,addUpDebtorNum:0,subjectName:"".concat(t.parentNode.number," ").concat(t.parentNode.subjectName),assist:{accountId:t.parentNode.accountId,subjectId:t.parentNode.subjectId,assistAdjuvantList:e}}),delete t.form.companyId,delete t.form.subjectAdjuvantList,delete t.form.initialId}))},immediate:!0}},methods:{getCrmType:function(t){return{1:"leads",2:"customer",3:"contacts",4:"product",5:"business",6:"contract",7:"receivables",8:"invoice"}[t]},relativeChange:function(t,e){e.relationId=t},generateData:function(t){if(!t)return[];var e=t.assist.assistAdjuvantList||[];if(!e||0===e.length)return[];var n=Object(N["s"])(e).filter((function(t){return t.relationId.length>0})),a=Math.max.apply(Math,Object(g["a"])(n.map((function(t){return t.relationId.length}))));if(0===a)return[];var i=0;n.forEach((function(t){var e=a-t.relationId.length;t.relationId.length>0&&i++,t.relationId=t.relationId.concat(Array(e).fill(null))}));for(var r=function(t,e){for(var n=[],a=0;a<t.length;a++)for(var i=t[a],r=0;r<e.length;r++){var c=e[r];n.push([].concat(Object(g["a"])(i),[c]))}return n},c=[[]],l=n.map((function(t){return t.relationId})),s=0;s<l.length;s++)c=r(c,l[s]);c=c.map((function(t){return t.join("-")})),c=Array.from(new Set(c)),c=c.map((function(t){return t.split("-")})).filter((function(t){return t.filter((function(t){return t})).length>=i}));var u=[];return c.forEach((function(t){var e=[];n.forEach((function(n,a){t[a]&&e.push(Object(o["a"])(Object(o["a"])({},n),{},{relationId:t[a]}))})),e.length>0&&u.push(e)})),u.map((function(e){var n=Object(N["s"])(t);return n.assist.assistAdjuvantList=e,Object(o["a"])(Object(o["a"])({},n),{},{initialBalanceNum:0,beginningNum:0,addUpDebtorNum:0,addUpCreditNum:0})}))},handleConfirm:function(){var t=this;if(!this.loading){var e=Object(N["s"])(this.form);e.assist.assistAdjuvantList.forEach((function(t){t.relationId=t.relationId.map((function(t){return t.carteId}))}));var n=e.assist.assistAdjuvantList.map((function(t){return{adjuvantId:t.adjuvantId,subjectId:t.subjectId,carteIdList:t.relationId}}));this.loading=!0,Object(l["w"])(n).then((function(e){setTimeout((function(){t.loading=!1,t.$emit("update"),t.handleClose()}),2e3)})).catch((function(){t.loading=!1}))}},handleClose:function(){this.dialogVisible=!1,this.$emit("close"),this.$emit("update:visible",!1)}}},S=k,U=(n("2bd8"),Object(p["a"])(S,m,v,!1,null,"61492476",null)),F=U.exports,L=n("6612"),$=n.n(L),V=n("2f62"),E=n("da92"),q=n("8c73"),z={name:"InitIalBalanceSet",components:{CalculateBalance:h,AddAssistDialog:F},data:function(){return{separator:q["h"],loading:!1,isRequest:!1,tableHeight:document.documentElement.clientHeight-300,balanceType:1,balanceTypeOptions:[{label:"资产",value:1},{label:"负债",value:2},{label:"权益",value:3},{label:"成本",value:4},{label:"损益",value:5}],currencyOptions:[],currencyType:"",startTime:"",calculateBalanceVisible:!1,balanceList:[],balanceData:[],allPrarentIds:[],tableShow:!0,addAssistVisible:!1,assistParentNode:null}},computed:Object(o["a"])(Object(o["a"])({},Object(V["c"])(["financeCurrentAccount"])),{},{isTheSameTime:function(){return this.$moment(this.financeCurrentAccount.enableTime).format("YYYYMM")===this.$moment(this.financeCurrentAccount.startTime).format("YYYYMM")}}),watch:{balanceType:function(t,e){var n=this;if(5==t&&"01"==this.startTime.split("-")[1])return this.balanceType=e,void this.$message.warning("年初启用的账套，不需要录入损益初始余额哦！");this.getBalanceGroupList(),this.balanceList=[],this.$nextTick((function(){n.getFieldList()}))},currencyType:function(){this.getBalanceGroupList()}},created:function(){var t=this;window.onresize=function(){t.tableHeight=document.documentElement.clientHeight-300},this.initStartTime(),this.getBalanceGroupList(),this.getCurrencyOptions()},methods:{importAll:function(){var t=this;this.$wkImport.import("fmInitialBalance",{typeName:"初始余额",historyShow:!1,noImportProcess:!0,ownerSelectShow:!1,repeatHandleShow:!1,downloadErrFuc:function(){var t=Object(c["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),importRequest:function(){var e=Object(c["a"])(Object(r["a"])().mark((function e(n){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(l["e"])(n).then((function(e){return t.initStartTime(),t.getBalanceGroupList(),t.getCurrencyOptions(),{data:{totalSize:e.data,errSize:0}}})));case 1:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}(),templateRequest:l["d"],userInfo:this.userInfo,coverShow:!1})},getBalanceGroupList:function(){this.getList(1,[],this.balanceType)},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0;this.balanceType===a&&(this.isRequest=!0,1===e&&(this.loading=!0),Object(l["x"])({subjectType:a,limit:500,pageType:1,page:e}).then((function(i){t.balanceType===a&&t.$nextTick((function(){t.balanceData=n.concat(i.data.list),t.loading=!1,t.balanceData.length<i.data.totalRow?t.getList(e+1,t.balanceData,a):(t.isRequest=!1,t.$nextTick((function(){t.allPrarentIds=t.balanceData.filter((function(t){return"0"!==t.parentId})).map((function(t){return t.parentId}))})))}))})).catch((function(){t.loading=!1})))},getCurrencyOptions:function(){var t=this;Object(l["u"])().then((function(e){t.currencyOptions=e.data}))},exportAll:function(){Object(l["b"])({subjectType:this.balanceType,limit:500,pageType:1,page:1}).then((function(t){Object(N["b"])(t)}))},getAssistName:function(t){return t.carteName?"".concat(t.subjectName,"_").concat(t.carteName):t.subjectName},getAssistNumber:function(t){return t.carteNumber?"".concat(t.number,"_").concat(t.carteNumber):t.number},getCellStyle:function(t){var e=t.row,n=(t.column,t.rowIndex,t.columnIndex);return 1!==n?{}:{paddingLeft:13*((e.grade||1)-1)+"px"}},initStartTime:function(){var t=this;Object(l["A"])().then((function(e){t.startTime=e.data.startTime,t.getFieldList()}))},fieldFormatter:function(t,e){return"balanceDirection"==e.field?1==t[e.field]?"借":"贷":t[e.field]},getFieldList:function(){var t=null,e=[{label:"科目编码",field:"number",width:130,fixed:"left"},{label:"科目名称",field:"subjectName",width:300},{label:"方向",field:"balanceDirection",width:80}],n={label:"期初余额",field:"initialBalance",type:"input",columns:[{label:"数量",field:"initialNum",type:"input",showType:"number"},{label:"金额",field:"initialBalance",type:"input"}]},a={label:"本年累计借方",field:"addUpDebtorBalance",type:"input",columns:[{label:"数量",field:"addUpDebtorNum",type:"input",showType:"number"},{label:"金额",field:"addUpDebtorBalance",type:"input"}]},i={label:"本年累计贷方",field:"addUpCreditBalance",type:"input",columns:[{label:"数量",field:"addUpCreditNum",type:"input",showType:"number"},{label:"金额",field:"addUpCreditBalance",type:"input"}]},r={label:"年初余额",field:"beginningBalance",type:"input",columns:[{label:"数量",field:"beginningNum",showType:"number"},{label:"金额",field:"beginningBalance"}]};"01"==this.startTime.split("-")[1]?(e[0].width=200,e[1].width=500,e[2].width=150,t=[].concat(e,[n])):t=5==this.balanceType?[].concat(e,[n,a,i,r,{label:"实际损益发生额",type:"input",field:"profitBalance",columns:[{label:"数量",field:"profitBalanceNum",type:"input",showType:"number"},{label:"金额",field:"profitBalance",type:"input"}]}]):[].concat(e,[n,a,i,r]),this.balanceList=t},inputPaste:function(t,e,n){var a=this;this.$nextTick((function(){e[n.field]=$()(t.target.value).format("0.00"),a.inputChange(e,n)}))},inputChange:function(t,e){var n,a;if(t.isChange=!0,1===t.balanceDirection?(n=(Number(t.initialBalance)||0)-(Number(t.addUpDebtorBalance)||0)+(Number(t.addUpCreditBalance)||0),a=(Number(t.initialNum)||0)-(Number(t.addUpDebtorNum)||0)+(Number(t.addUpCreditNum)||0)):(n=(Number(t.initialBalance)||0)+(Number(t.addUpDebtorBalance)||0)-(Number(t.addUpCreditBalance)||0),a=(Number(t.initialNum)||0)+(Number(t.addUpDebtorNum)||0)-(Number(t.addUpCreditNum)||0)),this.$set(t,"beginningNum",a||0),this.$set(t,"beginningBalance",n||0),t.assistId){var i=this.balanceData.find((function(e){return e.subjectId===t.subjectId&&e.subjectAdjuvantList})),r=Number(i.balanceDirection),c=this.balanceData.filter((function(e){return e.subjectId===t.subjectId&&e.assistId})),o=c.map((function(t){var n=Number(t[e.field]||0)||0,a=Number(t.balanceDirection);return["addUpDebtorBalance","addUpDebtorNum","addUpCreditNum","addUpCreditBalance"].includes(e.field)||r===a?n:-n})).reduce((function(t,e){return E["a"].plus(t,e)}));return this.$set(i,e.field,o),void this.inputChange(i,e)}var l=this.balanceData.find((function(e){return e.subjectId===t.parentId}));if(l){var s=Number(l.balanceDirection),u=this.balanceData.filter((function(e){return e.parentId===t.parentId&&!e.assistId})),d=u.map((function(t){var n=Number(t[e.field]||0)||0,a=Number(t.balanceDirection);return["addUpDebtorBalance","addUpDebtorNum","addUpCreditNum","addUpCreditBalance"].includes(e.field)||s===a?n:-n})).reduce((function(t,e){return E["a"].plus(t,e)}));this.$set(l,e.field,d),this.inputChange(l,e)}},handleSizeChange:function(t){this.pageSize=t,this.getBalanceGroupList()},handleToAddAssist:function(t){this.assistParentNode=t,this.addAssistVisible=!0},deleteAssistBalance:function(t){var e=this;t.isChange=!0;var n=["initialBalance","addUpDebtorBalance","addUpCreditBalance","beginningBalance","profitBalance"];if(t.isAmount&&(n=n.concat(["initialNum","addUpDebtorNum","addUpCreditNum","beginningNum","profitBalance"])),t.assistId){var a=this.balanceData.find((function(e){return e.subjectId===t.subjectId&&e.subjectAdjuvantList})),i=Number(a.balanceDirection),r=this.balanceData.filter((function(e){return e.subjectId===t.subjectId&&e.assistId&&e.assistId!==t.assistId})),c=r.map((function(t){var e={};return n.forEach((function(n){e[n]=function(){var e=Number(t[n]||0)||0,a=Number(t.balanceDirection);return["addUpDebtorBalance","addUpDebtorNum","addUpCreditNum","addUpCreditBalance"].includes(n)||i===a?e:-e}()})),e})),o={};if(c.length)o=c.reduce((function(t,e){var a={};return n.forEach((function(n){a[n]=E["a"].plus(t[n],e[n])})),a}));else{var l={};n.forEach((function(t){l[t]=0})),o=l}return n.forEach((function(t){e.$set(a,t,o[t])})),void this.deleteAssistBalance(a)}var s=this.balanceData.find((function(e){return e.subjectId===t.parentId}));if(s){var u=Number(s.balanceDirection),d=this.balanceData.filter((function(e){return e.parentId===t.parentId&&!e.assistId})),f=d.map((function(t){var e={};return n.forEach((function(n){e[n]=function(){var e=Number(t[n]||0)||0,a=Number(t.balanceDirection);return["addUpDebtorBalance","addUpDebtorNum","addUpCreditNum","addUpCreditBalance"].includes(n)||u===a?e:-e}()})),e})),p={};if(f.length)p=f.reduce((function(t,e){var a={};return n.forEach((function(n){a[n]=E["a"].plus(t[n],e[n])})),a}));else{var b={};n.forEach((function(t){b[t]=0})),p=b}n.forEach((function(t){e.$set(s,t,p[t])})),this.deleteAssistBalance(s)}},handleDeleteAssist:function(t){var e=this;Object(l["v"])({assistId:t.assistId}).then((function(n){e.deleteAssistBalance(t),e.saveSubmit(),e.$nextTick((function(){e.getBalanceGroupList()}))})).catch((function(t){}))},saveSubmit:function(){for(var t=this,e=[],n=0;n<this.balanceData.length;n++){var a=this.balanceData[n];a.isChange&&e.push({initialId:a.initialId,initialNum:a.initialNum,initialBalance:a.initialBalance,addUpDebtorNum:a.addUpDebtorNum,addUpDebtorBalance:a.addUpDebtorBalance,addUpCreditNum:a.addUpCreditNum,addUpCreditBalance:a.addUpCreditBalance,beginningNum:a.beginningNum,beginningBalance:a.beginningBalance,profitBalanceNum:a.profitBalanceNum,profitBalance:a.profitBalance})}5==this.balanceType&&e.find((function(t){return Number(t.beginningBalance)}))?this.$message.error("损益类科目的年初余额应该为零"):(this.loading=!0,Object(l["z"])(e).then((function(e){t.$message.success("保存成功"),t.getBalanceGroupList(),t.loading=!1})).catch((function(){t.loading=!1})))},trialBalance:function(){this.calculateBalanceVisible=!0},getDisabledStatus:function(t,e,n){if(!this.isTheSameTime)return!0;if(this.isRequest)return!0;if(!e.type||"input"!==e.type)return!0;if("number"===e.showType){if(t.subjectAdjuvantList){var a=this.balanceData[n+1];if(a)return a.number===t.number||Number(!t.isAmount)}return Number(!t.isAmount)||t.subjectAdjuvantList}if(this.allPrarentIds.includes(t.subjectId))return!0;if(t.subjectAdjuvantList){var i=this.balanceData[n+1];if(i)return i.subjectId===t.subjectId&&i.assistId}return!1}}},P=z,R=(n("e9a2"),Object(p["a"])(P,a,i,!1,null,"31378946",null));e["default"]=R.exports},4728:function(t,e,n){},"4ac2":function(t,e,n){},6062:function(t,e,n){n("1c59")},"7e59":function(t,e,n){},"8c0c":function(t,e,n){"use strict";n("3ef5")},b720:function(t,e,n){"use strict";n("d664")},cb29:function(t,e,n){var a=n("23e7"),i=n("81d5"),r=n("44d2");a({target:"Array",proto:!0},{fill:i}),r("fill")},cba6:function(t,e,n){"use strict";n("4728")},d664:function(t,e,n){},e9a2:function(t,e,n){"use strict";n("4ac2")}}]);